<!doctype html>
<html lang="en" data-bs-theme="dark">
    <!-- The data-bs-theme attribute is added to ensure Bootstrap components default to the correct theme -->
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{% block title %}LLMChat Web{% endblock %}</title>
        <!-- <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
        /> -->
        <!-- <link
            href="https://cdn.jsdelivr.net/npm/fastbootstrap@2.2.0/dist/css/fastbootstrap.min.css"
            rel="stylesheet"
            integrity="sha256-V6lu+OdYNKTKTsVFBuQsyIlDiRWiOmtC8VQ8Lzdm2i4="
            crossorigin="anonymous"
        /> -->
        <link
            rel="stylesheet"
            href="{{ url_for('static', filename='css/bootstrap.min.css') }}"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        />
        <!-- The main stylesheet now has an ID for JS targeting. -->
        <link
            id="main-theme-stylesheet"
            rel="stylesheet"
            href="{{ url_for('static', filename='css/custom.css') }}"
        />
        <!-- This link will be dynamically updated by JavaScript to load the selected theme override file. -->
        <link id="theme-override-stylesheet" rel="stylesheet" href="" />
        {% block head_extra %}{% endblock %}
    </head>
    <body class="d-flex flex-column h-100">
        <div id="app-container" class="d-flex flex-column flex-grow-1">
            {% block body %}{% endblock %}
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <!-- Ensure utils.js is loaded first as it initializes global state -->
        <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
        <!-- API modules can be loaded next -->
        <script src="{{ url_for('static', filename='js/session_api.js') }}"></script>
        <!-- UI modules that provide functions should be loaded before those that call them. -->
        <script src="{{ url_for('static', filename='js/rag_ui.js') }}"></script>
        <script src="{{ url_for('static', filename='js/llm_settings_ui.js') }}"></script>
        <script src="{{ url_for('static', filename='js/context_manager_ui.js') }}"></script>
        <script src="{{ url_for('static', filename='js/prompt_manager_ui.js') }}"></script>
        <script src="{{ url_for('static', filename='js/prompt_template_ui.js') }}"></script>
        <script src="{{ url_for('static', filename='js/ingestion_ui.js') }}"></script>
        <!-- UI modules that consume other functions can be loaded after. -->
        <script src="{{ url_for('static', filename='js/chat_ui.js') }}"></script>
        <!-- Main controller/initializer, loaded last to ensure all functions it calls are defined. -->
        <script src="{{ url_for('static', filename='js/main_controller.js') }}"></script>
        {% block scripts_extra %}{% endblock %}
    </body>
</html>
